<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <meta http-equiv="X-UA-Compatible" content="IE=edge;IE=11;IE=10;IE=9;IE=8;"/>
  <title>要素级次</title>
  <link rel="stylesheet" type="text/css" href="../../../../trd/ip/css/reset.css"/>
  <link rel="stylesheet" type="text/css" href="../../../../trd/bootstrap/css/bootstrap.min.css"/>
  <link rel="stylesheet" type="text/css" href="../../../../trd/uui/css/font-awesome.min.css">
  <link rel="stylesheet" type="text/css" href="../../../../trd/uui/css/u.min.css"/>
  <link rel="stylesheet" type="text/css" href="../../../../trd/uui/css/tree.min.css"/>
  <link rel="stylesheet" type="text/css" href="../../../../trd/ip/changeTree/changeTree.css"/>
  <link rel="stylesheet" type="text/css" href="../../../../trd/uui/css/grid.min.css"/>
  <link rel="stylesheet" type="text/css" href="../../../../trd/ip/css/ip.css"/>
  <link rel="stylesheet" type="text/css" href="../../../../trd/ip/css/platform.css"/>
  <link rel="stylesheet" type="text/css" href="../../config/ncrd.css"/>
  <!--[if lte IE 9]>
  <link rel="stylesheet" type="text/css" href="../ncrd-ie9.css"/>
  <![endif]-->
  <link rel="stylesheet" href="list.css">
</head>
<body>
<div class="height-full hide" id="main">
  <!--列表页面内容-->
  <div id="fl-list-container" class="container-fluid ncrd">
    <!-- 按钮 -->
    <div class="row list-box">
      <div class="mzc-head">
        <!-- 按钮组 -->
        <!-- <button type="button" class="btn btn-primary">完成</button>
        <button type="button" class="btn btn-primary">帮助</button> -->
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target=""
                @click="btnAddClick">增加
        </button>
        <button type="button" class="btn btn-primary" data-toggle="modal" data-target=""
                @click="btnEditClick">修改
        </button>
        <button type="button" class="btn btn-danger" data-toggle="modal" data-target=""
                @click="btnDelClick">删除
        </button>
      </div>
      <div class="list-div" style="">
        <div class="fix-left-top" id="fixLeftTop">
          <table class='table table-condensed table-bordered' style="margin-bottom: 0;">
            <tbody>
            <tr>
              <th class="bg-blue">
                <div class="text-center"><span>业务阶段</span></div>
              </th>
            </tr>
            <tr>
              <th
                  class="vtm u-grid-header-th"
                  :style="{height: row2col1.height+'px', width: row2col1.width+'px'}">
                <div class="text-center"><span>要素级次</span></div>
              </th>
            </tr>
            </tbody>
          </table>
        </div>
        <div class="fix-row" id="fixRow" style="background: #fff;">
          <!--固定行 -->
          <table class='table table-condensed table-bordered' style="margin-bottom: 0; margin-right: 100px;">
            <thead>
            <!--第一行-->
            <tr>
              <th v-for="(obj, i) in level01" :colspan="obj.children.length ? obj.children.length : 1"
                  class="text-center vtm bg-blue">
                <div>
                  <span v-text="obj.title"></span>
                </div>
              </th>
            </tr>
            <!--第二行-->
            <tr>
              <!--<td data-bind="text: $data[1]"></td>-->
              <th v-for="(obj, j) in row2"   class="vtm u-grid-header-th" style="border-bottom-width: 1px;">
                <div
                    class="text-center mzc-por"
                    @click="getCoa(obj)"
                    :style="{
                    width: j == 0 ? row2col1.width-1+'px' : cellWidthAndHeight.width-1+'px',
                    height: row2col1.height-1+'px'
                  }"
                    :class="{'mzc-bd': selectCoa.selected && obj[1] == selectCoa.coaId}">
                  <span class="mzc-center" v-text="obj[0]"></span>
                </div>
              </th>
            </tr>
            </thead>
          </table>
        </div>
        <div class="fix-col" id="fixCol" style="background: #fff;">
          <table class='table table-condensed table-bordered' style="margin-bottom: 0;">
            <thead>
            <tr>
              <th class="bg-blue">
                <div class="text-center"><span>业务阶段</span></div>
              </th>
            </tr>
            <tr>
              <th
                  class="vtm u-grid-header-th"
                  :style="{height: row2col1.height - 3 +'px', width: row2col1.width+'px'}">
                <div class="text-center"><span>要素级次</span></div>
              </th>
            </tr>
            </thead>
            <tbody>
            <tr v-for="(el, i) in els">
              <!--固定列-->
              <td>
                <div class="mzc-nowrap text-center mzc-por"
                     :style="{width: row2col1.width-1+'px', height: cellWidthAndHeight.height+'px'}">
                  <span class="mzc-center" v-text="el.ele_name"></span>
                  <!--<span data-bind="text: $data"></span>-->
                </div>
              </td>
            </tr>
            </tbody>
          </table>
        </div>
        <div id="mainContent" style="overflow: auto;" class="height-full">
          <!--表格列表 -->
          <table id='coa-list-table' class='table table-condensed table-bordered'>
            <thead style="visibility: hidden;">
            <!--第一行-->
            <tr>
              <th v-for="obj in level01"
                  :colspan="obj.children.length ? obj.children.length : 1"
                   class="text-center">
                <div>
                  <span v-text="obj.title"></span>
                </div>
              </th>
            </tr>
            <!--第二行-->
            <tr>
              <!--<template v-for="(item,i) in level01">-->
                <th  v-for="(obj, j) in row2" class="mzc-break-all"
                    :data-name="j == 0 && 'row2col1'"
                    >
                  <div
                       :class="{'mzc-bd': selectCoa.selected && obj[1] == selectCoa.coaId }"
                      >
                    <span v-text="obj[0]"></span>
                  </div>
                </th>
              <!--</template>-->
            </tr>
            </thead>
            <tbody>
            <tr v-for="(items, row) in body">
              <!--第一列-->
              <td style="visibility: hidden">
                <div class="mzc-nowrap text-center">
                  <span v-text="items[0].ele_name"></span>
                </div>
              </td>
              <!--后续列-->
              <!--<template v-for="(item, col) in items">-->
                <td v-if="col" v-for="(item, col) in items">
                  <div @click="getCoa(item)"
                       :style="{
                          width: cellWidthAndHeight.width-1+'px',
                          height: cellWidthAndHeight.height+'px',
                        }"
                       :class="{'mzc-bd': !selectCoa.selected &&　item.coaId == selectCoa.coaId && item.rowNum == selectCoa.rowNum}"
                       >
                    <div class="dropdown mzc-dropdown js-dropdown">
                      <a href="#" class="btn btn-default" data-toggle="dropdown" @click="point ={row: row, col: col}">
                        <span  v-text="item.levelName"></span>
                        <span class="caret"></span>
                      </a>
                      <ul v-if="items[0].max_level && row === point.row && col === point.col" class="dropdown-menu js-dropdown-menu">
                        <li v-for="obj in level.slice(0, Number(items[0].max_level)+1).concat(levelAny)">
                          <a href="#" v-text="obj.text" @click="changeSelect(item, obj)"></a>
                        </li>
                      </ul>
                      <ul v-if="!items[0].max_level && row === point.row && col === point.col" class="dropdown-menu">
                        <li v-for="obj in level.concat(levelAny)">
                          <a href="#" v-text="obj.text" @click="changeSelect(item, obj)"></a>
                        </li>
                      </ul>
                    </div>
                  </div>
                </td>
              <!--</template>-->
            </tr>
            </tbody>
          </table>
        </div>

      </div>
    </div>
  </div>

  <!-- Modal -->
  <div class="modal fade" id="cascadeModal" tabindex="-1" role="dialog" aria-labelledby="saveModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" @click="cancelSaveCoa" aria-label="Close"><span
              aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="myModalLabel">是否级联保存COA</h4>
        </div>
        <div class="modal-body">
          <pre v-text="cascadeText"></pre>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-primary" @click="saveCascadeCoa" >确定</button>
          <button type="button" class="btn btn-default" @click="cancelSaveCoa" >取消</button>
        </div>
      </div>
    </div>
  </div>

  <!--确认对话框-->
  <div class="modal fade" id="confirmModal" tabindex="-1" role="dialog" aria-labelledby="saveModalLabel">
    <div class="modal-dialog" role="document">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
              aria-hidden="true">&times;</span></button>
          <h4 class="modal-title">提示!</h4>
        </div>
        <div class="modal-body">
          <p class="modal-title">是否确认要删除: <span v-text="row2[selectCoa.colNum] && row2[selectCoa.colNum][0]"></span> ?</p>
          <!--<p class="modal-title">是否确认要删除: <span data-bind="text: selectCoa.colNum()"></span> ?</p>-->
        </div>
        <div class="modal-footer" style="border-top: none;">
          <button type="button" class="btn btn-primary" @click="confirmDelCoa">确定</button>
          <button type="button" class="btn btn-default" data-dismiss="modal">取消</button>
        </div>
      </div>
    </div>
  </div>

  <div class="mzc-loading hide" id="myLoading"></div>
</div>
<div style="font-size: 30px; position: fixed; top: 40%; left: 47%;" id="on-loading">加载中...</div>

<!--引入js-->
<script src="vue.min.js"></script>
<script src="../../../../trd/requirejs/require.debug.js"></script>
<script src="../../../../require.config.js"></script>
<script src="list.js" type="text/javascript"></script>
<!--<script src="http://localhost:3000/myWorkspace/gov.df.fap/gov.df.fap.web/src/main/webapp/df/fap/system/basesetting/factorylevel/list.js" type="text/javascript"></script>-->
<script>
</script>
</body>
</html>